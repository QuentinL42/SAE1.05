<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Rapport d'analyse r√©seau</title>
    <style>
        :root {
            --bg-color: #f5f7fa;
            --text-color: #222222;
            --card-bg: #ffffff;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.1);
            --header-bg: linear-gradient(135deg, #005bea, #00c6fb);
            --table-border: #dddddd;
            --menace-bg: #ffecec;
            --menace-border: #ff4d4d;
        }
        body.dark {
            --bg-color: #1e1e1e;
            --text-color: #e0e0e0;
            --card-bg: #2b2b2b;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.6);
            --header-bg: linear-gradient(135deg, #141e30, #243b55);
            --table-border: #555555;
            --menace-bg: #3b1f1f;
            --menace-border: #ff6b6b;
        }
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            transition: background 0.3s, color 0.3s;
        }
        header {
            background: var(--header-bg);
            padding: 25px;
            text-align: center;
            color: white;
        }
        .container {
            width: 90%;
            max-width: 1100px;
            margin: 30px auto;
        }
        .card {
            background: var(--card-bg);
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            transition: background 0.3s, box-shadow 0.3s;
        }
        h2 {
            color: #005bea;
            border-left: 5px solid #00c6fb;
            padding-left: 10px;
        }
        body.dark h2 {
            color: #66aaff;
            border-left-color: #3399ff;
        }
        .menaces li {
            background: var(--menace-bg);
            border-left: 5px solid var(--menace-border);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            list-style: none;
        }
        footer {
            text-align: center;
            padding: 15px;
            background: #e9eef5;
            margin-top: 30px;
        }
        body.dark footer {
            background: #252525;
        }
        table {
            color: inherit;
        }
        #scoreTable th, #scoreTable td {
            border: 1px solid var(--table-border);
        }
        /* Texte du tableau toujours noir pour lisibilit√© */
        #scoreTable td,
        #scoreTable th {
            color: #000000 !important;
        }
        body.dark #scoreTable td,
        body.dark #scoreTable th {
            color: #000000 !important;
        }
        .top-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .top-controls input[type="number"] {
            width: 70px;
            padding: 4px;
        }
        .btn {
            padding: 6px 12px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            background: #005bea;
            color: white;
        }
        .btn:hover {
            background: #0040b3;
        }
        body.dark .btn {
            background: #3399ff;
        }
        body.dark .btn:hover {
            background: #1f7ad1;
        }
        .btn-secondary {
            background: #666666;
        }
        body.dark .btn-secondary {
            background: #444444;
        }
        .btn-secondary:hover {
            background: #555555;
        }
        body.dark .btn-secondary:hover {
            background: #333333;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<header>
    <h1>Rapport d'analyse r√©seau</h1>
</header>

<div class="container">

    <div class="card">
        <div class="top-controls">
            <h2 style="margin:0;">üî• Score de dangerosit√© par IP</h2>
            <div>
                <label for="topN">Afficher Top N IP :</label>
                <input type="number" id="topN" value="10" min="1">
                <button class="btn" onclick="applyTopN()">Mettre √† jour</button>
            </div>
            <button class="btn btn-secondary" onclick="toggleDarkMode()">Mode sombre / clair</button>
        </div>
        <canvas id="scoreChart" height="120"></canvas>

        <h2>Tableau des scores</h2>
        <table id='scoreTable' style='width:100%; border-collapse: collapse;'><thead><tr style='background:#005bea;color:white;'><th style='padding:8px;border:1px solid #ddd;'>IP</th><th style='padding:8px;border:1px solid #ddd;'>Score</th></tr></thead><tbody><tr class='dataRow' style='background:#ff4d4d;'><td style='padding:8px;border:1px solid #ddd;color:black;'>BP-Linux8</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>159</td></tr><tr class='dataRow' style='background:#ff4d4d;'><td style='padding:8px;border:1px solid #ddd;color:black;'>www.aggloroanne.fr</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>106</td></tr><tr class='dataRow' style='background:#ff4d4d;'><td style='padding:8px;border:1px solid #ddd;color:black;'>190-0-175-100.gba.solunet.com.ar</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>100</td></tr><tr class='dataRow' style='background:#ff4d4d;'><td style='padding:8px;border:1px solid #ddd;color:black;'>mauves.univ-st-etienne.fr</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>84</td></tr><tr class='dataRow' style='background:#ff4d4d;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par10s38-in-f3.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>41</td></tr><tr class='dataRow' style='background:#ffe066;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s23-in-f3.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>12</td></tr><tr class='dataRow' style='background:#ffe066;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s04-in-f4.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>11</td></tr><tr class='dataRow' style='background:#ffe066;'><td style='padding:8px;border:1px solid #ddd;color:black;'>190</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>10</td></tr><tr class='dataRow' style='background:#ffe066;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s17-in-f1.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>9</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s23-in-f10.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>4</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>192.168.190.130</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>3</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s17-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>2</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s20-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>2</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s11-in-f10.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>1</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s05-in-f131.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>1</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par10s40-in-f3.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>1</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>91.121.37.244</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>1</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s11-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>1</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>ec2-34-211-70-226.us-west-2.compute.amazonaws.com</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>93.184.220.29</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>104.18.31.182</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>201.181.244.35.bc.googleusercontent.com</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>ec2-35-166-112-194.us-west-2.compute.amazonaws.com</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>mad01s26-in-f174.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s20-in-f2.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>server-54-230-114-73.mrs52.r.cloudfront.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>lhr25s01-in-f2.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par10s28-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s12-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par10s40-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s23-in-f2.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>server-54-230-114-7.mrs52.r.cloudfront.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>server-54-230-114-122.mrs52.r.cloudfront.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s18-in-f3.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s20-in-f10.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>par21s22-in-f14.1e100.net</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr><tr class='dataRow' style='background:#b3ffb3;'><td style='padding:8px;border:1px solid #ddd;color:black;'>82.221.107.34.bc.googleusercontent.com</td><td style='padding:8px;border:1px solid #ddd;text-align:center;color:black;'>0</td></tr></tbody></table>
    </div>

    <div class="card">
        <h2>üö® D√©tail des menaces d√©tect√©es</h2>
        <ul class="menaces">
            <li>Suspicion de scan HTTP : 2000 paquets SYN depuis 190-0-175-100.gba.solunet.com.ar vers 184.107.43.74.</li><li>Trafic SSH important entre 192.168.190.130 et BP-Linux8 (‚âà 6188 octets).</li>
        </ul>
    </div>

</div>

<footer>
    Rapport g√©n√©r√© automatiquement ‚Äî Analyse r√©seau & s√©curit√©
</footer>

<script>
    const labelsAll = ["BP-Linux8", "www.aggloroanne.fr", "190-0-175-100.gba.solunet.com.ar", "mauves.univ-st-etienne.fr", "par10s38-in-f3.1e100.net", "par21s23-in-f3.1e100.net", "par21s04-in-f4.1e100.net", "190", "par21s17-in-f1.1e100.net", "par21s23-in-f10.1e100.net", "192.168.190.130", "par21s17-in-f14.1e100.net", "par21s20-in-f14.1e100.net", "par21s11-in-f10.1e100.net", "par21s05-in-f131.1e100.net", "par10s40-in-f3.1e100.net", "91.121.37.244", "par21s11-in-f14.1e100.net", "ec2-34-211-70-226.us-west-2.compute.amazonaws.com", "93.184.220.29", "104.18.31.182", "201.181.244.35.bc.googleusercontent.com", "ec2-35-166-112-194.us-west-2.compute.amazonaws.com", "mad01s26-in-f174.1e100.net", "par21s20-in-f2.1e100.net", "server-54-230-114-73.mrs52.r.cloudfront.net", "lhr25s01-in-f2.1e100.net", "par10s28-in-f14.1e100.net", "par21s12-in-f14.1e100.net", "par10s40-in-f14.1e100.net", "par21s23-in-f2.1e100.net", "server-54-230-114-7.mrs52.r.cloudfront.net", "server-54-230-114-122.mrs52.r.cloudfront.net", "par21s18-in-f3.1e100.net", "par21s20-in-f10.1e100.net", "par21s22-in-f14.1e100.net", "82.221.107.34.bc.googleusercontent.com"];
    const scoresAll = [159, 106, 100, 84, 41, 12, 11, 10, 9, 4, 3, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    let scoreChart = null;
    let isDark = false;

    function buildChart(N) {
        const ctx = document.getElementById('scoreChart').getContext('2d');
        const labels = labelsAll.slice(0, N);
        const data = scoresAll.slice(0, N);

        const textColor = isDark ? '#e0e0e0' : '#222222';
        const gridColor = isDark ? '#555555' : '#cccccc';

        if (scoreChart) {
            scoreChart.destroy();
        }

        scoreChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Score de dangerosit√©',
                    data: data,
                    backgroundColor: data.map(v => {
                        if (v >= 30) return '#ff4d4d';
                        if (v >= 15) return '#ff944d';
                        if (v >= 5) return '#ffe066';
                        return '#b3ffb3';
                    }),
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        labels: {
                            color: textColor
                        }
                    },
                    tooltip: {
                        enabled: true
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            color: textColor
                        },
                        grid: {
                            color: gridColor
                        }
                    },
                    y: {
                        beginAtZero: true,
                        ticks: {
                            color: textColor
                        },
                        grid: {
                            color: gridColor
                        }
                    }
                }
            }
        });
    }

    function applyTopN() {
        let N = parseInt(document.getElementById('topN').value);
        if (isNaN(N) || N < 1) N = 10;

        const rows = document.querySelectorAll('#scoreTable tr.dataRow');
        rows.forEach((row, idx) => {
            row.style.display = idx < N ? 'table-row' : 'none';
        });

        buildChart(N);
    }

    function toggleDarkMode() {
        isDark = !isDark;
        document.body.classList.toggle('dark', isDark);
        let N = parseInt(document.getElementById('topN').value);
        if (isNaN(N) || N < 1) N = 10;
        buildChart(N);
    }

    window.onload = function() {
        applyTopN();
    };
</script>

</body>
</html>
